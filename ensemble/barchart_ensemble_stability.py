import matplotlib.pyplot as plt
import numpy as np

import ensemble.ensemble_analysis as anal

data = np.array(
    [[0.43261589, 0.43294241, 0.42972927, 0.43075162, 0.43757791],
     [0.43261589, 0.43186731, 0.43127612, 0.43140499, 0.43278023],
     [0.43261589, 0.43354435, 0.43137116, 0.43979817, 0.4318302],
     [0.43261589, 0.43401075, 0.43357966, 0.43176529, 0.43433074],
     [0.43261589, 0.43291018, 0.43399067, 0.43158418, 0.43596825],
     [0.43261589, 0.43437093, 0.43151778, 0.43179461, 0.42808029],
     [0.43261589, 0.43087432, 0.43381438, 0.43433206, 0.43312755],
     [0.43261589, 0.4325952, 0.43198721, 0.43472154, 0.43221649],
     [0.43261589, 0.43231302, 0.43347685, 0.43315734, 0.43179239],
     [0.43261589, 0.43426269, 0.43097042, 0.43383337, 0.43346096],
     [0.43261589, 0.43194876, 0.43292229, 0.43189093, 0.43659843],
     [0.43261589, 0.43187331, 0.43414872, 0.43011297, 0.43144491],
     [0.43261589, 0.43316831, 0.43320993, 0.43191407, 0.4335633],
     [0.43261589, 0.43306923, 0.43380057, 0.43198729, 0.43553621],
     [0.43261589, 0.43409117, 0.43293838, 0.43238604, 0.43134295],
     [0.43261589, 0.4324494, 0.43253682, 0.43351552, 0.43192375],
     [0.43261589, 0.43404884, 0.43087125, 0.43527329, 0.43091761],
     [0.43261589, 0.43233947, 0.4326377, 0.4294466, 0.43225708],
     [0.43261589, 0.43337315, 0.43193095, 0.43277284, 0.4327465],
     [0.43261589, 0.43292517, 0.43613227, 0.43158826, 0.43020546],
     [0.43261589, 0.43239045, 0.43182352, 0.42827473, 0.43704609],
     [0.43261589, 0.43305587, 0.43076691, 0.43900213, 0.43284438],
     [0.43261589, 0.43348854, 0.43060488, 0.43072442, 0.43116712],
     [0.43261589, 0.43290646, 0.43366904, 0.43528845, 0.43262517],
     [0.43261589, 0.43289634, 0.43160503, 0.43158627, 0.43991222],
     [0.43261589, 0.43280442, 0.43176761, 0.43289647, 0.43388668],
     [0.43261589, 0.43109741, 0.43232875, 0.43346552, 0.42990958],
     [0.43261589, 0.43081438, 0.43324913, 0.43128215, 0.4294615],
     [0.43261589, 0.43221257, 0.43462882, 0.43080039, 0.43418056],
     [0.43261589, 0.43313376, 0.43246288, 0.43364451, 0.43197391],
     [0.43261589, 0.43202589, 0.43242548, 0.43217131, 0.43575268],
     [0.43261589, 0.43372124, 0.43111887, 0.43267288, 0.44029985],
     [0.43261589, 0.43320703, 0.43375618, 0.43172206, 0.4348755],
     [0.43261589, 0.43237565, 0.43217767, 0.43416411, 0.43683854],
     [0.43261589, 0.43287921, 0.43604149, 0.42864795, 0.43157238],
     [0.43261589, 0.43397154, 0.43068392, 0.43596563, 0.43182766],
     [0.43261589, 0.43313602, 0.43173495, 0.43128034, 0.43272435],
     [0.43261589, 0.43213565, 0.433917, 0.43555638, 0.44107835],
     [0.43261589, 0.43291373, 0.43806144, 0.43110174, 0.43044836],
     [0.43261589, 0.43048639, 0.43418409, 0.43428205, 0.4311885],
     [0.43261589, 0.43342217, 0.43357031, 0.44057335, 0.43261015],
     [0.43261589, 0.4312671, 0.43235832, 0.43320342, 0.43628047],
     [0.43261589, 0.43397731, 0.43251868, 0.43351579, 0.43277876],
     [0.43261589, 0.43432968, 0.4312808, 0.4340513, 0.4364327],
     [0.43261589, 0.43226815, 0.43399659, 0.42947777, 0.43552119],
     [0.43261589, 0.43368186, 0.43332822, 0.43180962, 0.43497287],
     [0.43261589, 0.43319636, 0.43366619, 0.43651288, 0.43106535],
     [0.43261589, 0.43364523, 0.43051531, 0.43287204, 0.43360064],
     [0.43261589, 0.4324398, 0.42910921, 0.43016422, 0.43484469],
     [0.43261589, 0.43309758, 0.43703426, 0.4346259, 0.43299082],
     [0.43261589, 0.43161241, 0.43165487, 0.43107744, 0.43564049],
     [0.43261589, 0.43247677, 0.43284314, 0.43306403, 0.43248463],
     [0.43261589, 0.4331342, 0.43321235, 0.43736608, 0.42964816],
     [0.43261589, 0.43239493, 0.43197492, 0.43527175, 0.43275066],
     [0.43261589, 0.43003397, 0.43050637, 0.43316152, 0.43776868],
     [0.43261589, 0.43399484, 0.43341779, 0.4342038, 0.43629802],
     [0.43261589, 0.43227616, 0.42978727, 0.43438787, 0.42930905],
     [0.43261589, 0.43245844, 0.43556598, 0.43197686, 0.43995001],
     [0.43261589, 0.43230523, 0.43296499, 0.43049661, 0.43040812],
     [0.43261589, 0.43269829, 0.435669, 0.43654838, 0.43082066],
     [0.43261589, 0.43348009, 0.43222662, 0.43079716, 0.43231786],
     [0.43261589, 0.43395713, 0.43198352, 0.43498477, 0.43474787],
     [0.43261589, 0.43246632, 0.43226862, 0.43025769, 0.43110584],
     [0.43261589, 0.43222322, 0.43130922, 0.43434324, 0.43423576],
     [0.43261589, 0.43326806, 0.43181048, 0.430929, 0.43697908],
     [0.43261589, 0.4326345, 0.43628932, 0.43648865, 0.43352858],
     [0.43261589, 0.42997833, 0.43565618, 0.43181779, 0.43249784],
     [0.43261589, 0.43485305, 0.43382848, 0.43427176, 0.43338897],
     [0.43261589, 0.43022793, 0.43214526, 0.43017331, 0.43097947],
     [0.43261589, 0.43353655, 0.43257391, 0.43132355, 0.43378852],
     [0.43261589, 0.43208531, 0.43226926, 0.43340005, 0.43500657],
     [0.43261589, 0.43337585, 0.43069972, 0.43239564, 0.43496715],
     [0.43261589, 0.43207604, 0.43070027, 0.4347058, 0.43162336],
     [0.43261589, 0.4335205, 0.43081391, 0.4322479, 0.43569015],
     [0.43261589, 0.43050124, 0.42970613, 0.43416241, 0.43678234],
     [0.43261589, 0.43464124, 0.43425479, 0.43121987, 0.43367589],
     [0.43261589, 0.43394644, 0.43196498, 0.43325875, 0.43170949],
     [0.43261589, 0.43335821, 0.43345317, 0.43548675, 0.43773494],
     [0.43261589, 0.43261842, 0.43566308, 0.43132173, 0.4350418],
     [0.43261589, 0.43275664, 0.43273985, 0.42999683, 0.43166765],
     [0.43261589, 0.4316613, 0.4307485, 0.43286582, 0.43226133],
     [0.43261589, 0.43394195, 0.43090292, 0.43140984, 0.43707498],
     [0.43261589, 0.43484931, 0.43446715, 0.43115907, 0.42985168],
     [0.43261589, 0.43351569, 0.43463997, 0.43123099, 0.43986665],
     [0.43261589, 0.43243981, 0.43333929, 0.43359574, 0.43535499],
     [0.43261589, 0.43136148, 0.43303908, 0.43212502, 0.4316731],
     [0.43261589, 0.43381548, 0.43204436, 0.43187419, 0.4360338],
     [0.43261589, 0.43326155, 0.43409532, 0.43108398, 0.43631008],
     [0.43261589, 0.43269807, 0.43527216, 0.43388574, 0.43030547],
     [0.43261589, 0.43192241, 0.43351592, 0.43367088, 0.43204511],
     [0.43261589, 0.43253306, 0.43394563, 0.4369921, 0.43077342],
     [0.43261589, 0.43357673, 0.43387914, 0.43222082, 0.43586448],
     [0.43261589, 0.43127556, 0.43715697, 0.42872032, 0.43670208],
     [0.43261589, 0.43278092, 0.43261964, 0.42970558, 0.43354291],
     [0.43261589, 0.43343851, 0.43068405, 0.43392325, 0.43200303],
     [0.43261589, 0.43261055, 0.43364879, 0.4287525, 0.43075981],
     [0.43261589, 0.43184871, 0.42996592, 0.43299667, 0.43281732],
     [0.43261589, 0.43162584, 0.43287405, 0.42874556, 0.4315651],
     [0.43261589, 0.43196751, 0.43848934, 0.43167572, 0.43534581],
     [0.43261589, 0.43241299, 0.43129645, 0.43133436, 0.43670935]
     ]
)

x_labels = 100 - np.linspace(0, 0.1, 5) * 100 - 80
loss_mean = np.average(data, axis=0)
loss_std = np.std(data, axis=0)
ind = np.arange(x_labels.shape[0])  # the x locations for the groups
width = 0.35  # the width of the bars

plt.bar(ind, loss_mean, width, color='r', yerr=loss_std)

plt.ylim((np.min(loss_mean) - 0.01, np.max(loss_mean) + 0.01))
plt.ylabel('Average logloss ensemble over 100 runs')
plt.title('Ensemble performance stability with reduced validation data')
plt.xticks(ind, x_labels)
plt.xlabel('% validation data')

plt.savefig(anal.analysis_dir + '/ensemble_stability.png')
